const express = require('express');
const http = require('http');
const { Server } = require('socket.io');

const app = express();
const server = http.createServer(app);
const io = new Server(server, {
  cors: {
    origin: '*'
  }
});

app.use(express.static(__dirname + '/public'));
// âš ï¸ Ð½Ðµ Ð½ÑƒÐ¶Ð½Ð¾ Ñ€ÑƒÑ‡ÐºÐ°Ð¼Ð¸ Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡Ð°Ñ‚ÑŒ socket.io.js â€” ÑÐµÑ€Ð²ÐµÑ€ Ð¾Ñ‚Ð´Ð°Ñ‘Ñ‚ ÑÐ°Ð¼

io.on('connection', (socket) => {
  console.log('ðŸ”Œ ÐÐ¾Ð²Ð¾Ðµ Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ');

  socket.on('chat message', (msg) => {
    // Ð¾Ñ‚Ð¿Ñ€Ð°Ð²Ð»ÑÐµÐ¼ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ Ð²ÑÐµÐ¼ Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡Ñ‘Ð½Ð½Ñ‹Ð¼ ÐºÐ»Ð¸ÐµÐ½Ñ‚Ð°Ð¼
    io.emit('chat message', msg);
  });

  socket.on('balance update', (data) => {
    // Ñ€Ð°ÑÑÑ‹Ð»Ð°ÐµÐ¼ Ð½Ð¾Ð²ÑƒÑŽ ÑÑƒÐ¼Ð¼Ñƒ Ð±Ð°Ð»Ð°Ð½ÑÐ° Ð²ÑÐµÐ¼ ÐºÐ»Ð¸ÐµÐ½Ñ‚Ð°Ð¼
    io.emit('balance update', data);
  });

  socket.on('rating update', (data) => {
    // Ñ€Ð°ÑÑÑ‹Ð»Ð°ÐµÐ¼ Ð½Ð¾Ð²Ð¾Ðµ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ Ñ€ÐµÐ¹Ñ‚Ð¸Ð½Ð³Ð° Ð²ÑÐµÐ¼ ÐºÐ»Ð¸ÐµÐ½Ñ‚Ð°Ð¼
    io.emit('rating update', data);
  });
});

const PORT = 3000;
server.listen(PORT, () => {
  console.log(`ðŸš€ Ð¡ÐµÑ€Ð²ÐµÑ€ Ð·Ð°Ð¿ÑƒÑ‰ÐµÐ½ Ð½Ð° http://localhost:${PORT}`);
});
